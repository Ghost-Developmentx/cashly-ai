                                                                                                                           [100%======================================================================================================= FAILURES ========================================================================================================
__________________________________________________________________________________________________ test_analyze_trends __________________________________________________________________________________________________

client = <httpx.AsyncClient object at 0x7fc0c671c1d0>

    @pytest.mark.asyncio
    async def test_analyze_trends(client):
        """Test trend analysis endpoint."""
        # Create test transactions
        transactions = []
        base_date = datetime.now() - timedelta(days=90)

        for i in range(90):
            transactions.append(
                {
                    "date": (base_date + timedelta(days=i)).strftime("%Y-%m-%d"),
                    "amount": -50.0 - (i % 30),  # Increasing spending
                    "category": "Food" if i % 3 == 0 else "Transport",
                    "description": f"Transaction {i}",
                }
            )

        request_data = {
            "user_id": "test_user",
            "transactions": transactions,
            "period": "3m",
        }

        response = await client.post("/api/v1/insights/trends", json=request_data)

>       assert response.status_code == 200
E       assert 500 == 200
E        +  where 500 = <Response [500 Internal Server Error]>.status_code

tests/api/v1/test_insights.py:34: AssertionError
------------------------------------------------------------------------------------------------- Captured stdout call --------------------------------------------------------------------------------------------------
ðŸ“¥ Incoming request: POST http://test/api/v1/insights/trends
------------------------------------------------------------------------------------------------- Captured stderr call --------------------------------------------------------------------------------------------------
ERROR [app.api.v1.endpoints.insights] Trend analysis failed: 2 validation errors for TrendAnalysisResponse
income_trends.highest_month.month
  Input should be a valid number, unable to parse string as a number [type=float_parsing, input_value='', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/float_parsing
income_trends.lowest_month.month
  Input should be a valid number, unable to parse string as a number [type=float_parsing, input_value='', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/float_parsing
Traceback (most recent call last):
  File "/home/ghost/projects/cashly-ai/app/api/v1/endpoints/insights.py", line 74, in analyze_trends
    response = TrendAnalysisResponse(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ghost/.cache/pypoetry/virtualenvs/cashly-ai-yRLFXMn3-py3.12/lib/python3.12/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 2 validation errors for TrendAnalysisResponse
income_trends.highest_month.month
  Input should be a valid number, unable to parse string as a number [type=float_parsing, input_value='', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/float_parsing
income_trends.lowest_month.month
  Input should be a valid number, unable to parse string as a number [type=float_parsing, input_value='', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/float_parsing
--------------------------------------------------------------------------------------------------- Captured log call ---------------------------------------------------------------------------------------------------
ERROR    app.api.v1.endpoints.insights:insights.py:93 Trend analysis failed: 2 validation errors for TrendAnalysisResponse
income_trends.highest_month.month
  Input should be a valid number, unable to parse string as a number [type=float_parsing, input_value='', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/float_parsing
income_trends.lowest_month.month
  Input should be a valid number, unable to parse string as a number [type=float_parsing, input_value='', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/float_parsing
Traceback (most recent call last):
  File "/home/ghost/projects/cashly-ai/app/api/v1/endpoints/insights.py", line 74, in analyze_trends
    response = TrendAnalysisResponse(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ghost/.cache/pypoetry/virtualenvs/cashly-ai-yRLFXMn3-py3.12/lib/python3.12/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 2 validation errors for TrendAnalysisResponse
income_trends.highest_month.month
  Input should be a valid number, unable to parse string as a number [type=float_parsing, input_value='', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/float_parsing
income_trends.lowest_month.month
  Input should be a valid number, unable to parse string as a number [type=float_parsing, input_value='', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/float_parsing